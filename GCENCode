with open("Copci_JGI_and_2021_joined", "r") as Copci_2021_JGi, open("Copci_prots.fa.tsv", 'r') as JGI_Interpro, open("Copci_2021_CC2G.fa.tsv", 'r') as Copci_2021:
    Copci_2021_proteins=set()
    JGI_Copci_proteins=set()
    Copci_2021_interproannotations={}
    JGI_copci_interproannotations={}
    for CC2021_prot in Copci_2021_JGi:
        Field1=CC2021_prot.strip().split()[0]
        Field3=CC2021_prot.strip().split()[2]

        if "CC2G" in Field1:
            Copci_2021_proteins.add(Field1)
        elif "CC2G" in Field3:
            Copci_2021_proteins.add(Field3)

        if "jgi" in Field1:
            JGI_Copci_proteins.add(Field1)
        elif "jgi" in Field3:
            JGI_Copci_proteins.add(Field3)
    #now to create a dictionary, with the following parameters
    #make a dictionary of every protein in the 2021 file
    #make a dictionary of every protein in the 2021 file, key is protein name, value is
    for Dictionary_2021 in Copci_2021:
        fields = Dictionary_2021.strip().split()
        Field1 = fields[0]
        if "IPR" in Dictionary_2021:
            Fields_second_last = Dictionary_2021.strip().split("IPR")[1]
            Fields_second_last_1 = Fields_second_last.strip().split('\t', 1)[1]
            Fields_second_last_2 = '\t'.join(Fields_second_last_1.split('\t')[:-1])
            Fields_second_last_2 = '-'.join(Fields_second_last_2.split())
            if any(Name in Field1 for Name in Copci_2021_proteins):
                if Field1 not in Copci_2021_interproannotations:
                    Copci_2021_interproannotations[Field1] = [Fields_second_last_2]
                else:
                    Copci_2021_interproannotations[Field1].append(Fields_second_last_2)
    for Dictionary_JGI in JGI_Interpro:
        fields = Dictionary_JGI.strip().split()
        Field1 = fields[0]
        if "IPR" in Dictionary_JGI:
            Fields_second_last = Dictionary_JGI.strip().split("IPR")[1]
            Fields_second_last_1 = Fields_second_last.strip().split('\t', 1)[1]
            Fields_second_last_2 = '\t'.join(Fields_second_last_1.split('\t')[:-1])
            Fields_second_last_2 = '-'.join(Fields_second_last_2.split())
            if any(Name in Field1 for Name in JGI_Copci_proteins):
                if Field1 not in Copci_2021_interproannotations:
                    JGI_copci_interproannotations[Field1] = Fields_second_last_2
                else:
                    JGI_copci_interproannotations[Field1].append(Fields_second_last_2)
with open("Copci_JGI_and_2021_joined", "r") as Copci_2021_JGi, open("Row_bind_annotationsadded", 'w') as output:
    headers = Copci_2021_JGi.readline().strip().split("\t")
    headers.insert(0, "Annotation")
    output_headers = "\t".join(headers)
    output.write(output_headers + "\n")  # Write the modified headers to the output file

    # Skip the first line of the input file (header line)
    next(Copci_2021_JGi)

    for line in Copci_2021_JGi:
        fields = line.strip().split("\t")
        Field1 = fields[0]
        annotation = ""
        if Field1 in Copci_2021_interproannotations:
            annotation = "".join(Copci_2021_interproannotations[Field1])
        elif Field1 in JGI_copci_interproannotations:
            annotation = "".join(JGI_copci_interproannotations[Field1])
        fields.insert(0, annotation)

        # Join the fields back together and write to the output file
        output_line = "\t".join(fields)
        output.write(output_line + "\n")

with open("Copci_JGI_and_2021_joined", "r") as Copci_2021_JGi, open("Row_bind_annotationsadded_orthologuesaswell", 'w') as output:
    headers = Copci_2021_JGi.readline().strip().split("\t")
    headers.insert(0, "Annotation")
    headers.insert(3, "Orthologue_annotation")  # Insert the new column name at the 4th position
    output_headers = "\t".join(headers)
    output.write(output_headers + "\n")  # Write the modified headers to the output file

    # Skip the first line of the input file (header line)
    next(Copci_2021_JGi)

    for line in Copci_2021_JGi:
        fields = line.strip().split("\t")
        Field1 = fields[0]
        Field3 = fields[2]
        annotation = ""

        # Populate the "Annotation" column
        if Field1 in Copci_2021_interproannotations:
            annotation = "".join(Copci_2021_interproannotations[Field1])
        elif Field1 in JGI_copci_interproannotations:
            annotation = "".join(JGI_copci_interproannotations[Field1])
        fields.insert(0, annotation)

        # Populate the "Orthologue_annotation" column
        annotation = ""
        if Field3 in Copci_2021_interproannotations:
            annotation = "".join(Copci_2021_interproannotations[Field3])
        elif Field3 in JGI_copci_interproannotations:
            annotation = "".join(JGI_copci_interproannotations[Field3])
        fields.insert(3, annotation)
        # Move the values to the right of the insertion point to the next column



        # Join the fields back together and write to the output file
        output_line = "\t".join(fields)
        output.write(output_line + "\n")
